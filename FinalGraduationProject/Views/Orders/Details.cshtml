@model FinalGraduationProject.Models.Order

@{
    ViewData["Title"] = "Order Details";
}

<main class="page py-5" style="background:#f8f9fa;">
    <div class="container">
        <!-- عنوان -->
        <div class="text-center mb-5">
            <h1 class="fw-bold text-primary">
                Order #@Model.Id
            </h1>
            <p class="text-muted fs-5">Review all details for this order</p>
        </div>

        <!-- بيانات أساسية -->
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-md-4">
                        <strong>Date:</strong> @Model.OrderDate.ToString("yyyy-MM-dd HH:mm")
                    </div>
                    <div class="col-md-4">
                        <strong>Status:</strong>
                        <span class="badge bg-primary bg-opacity-75">@Model.Status</span>
                    </div>
                    <div class="col-md-4">
                        <strong>Total:</strong>
                        <span class="fw-bold text-price">
                            $@Model.TotalAmount.ToString("F2")
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- عناصر الطلب -->
        <div class="card shadow-sm">
            <div class="card-header bg-light">
                <h5 class="mb-0">
                    <i class="fas fa-box me-2"></i> Items
                </h5>
            </div>
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Product</th>
                            <th>Size</th>
                            <th>Quantity</th>
                            <th>Unit Price</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.OrderItems)
                        {
                            <tr>
                                <td>@item.ProductSize.Product.Name</td>
                                <td>@item.ProductSize.Size.Name</td>
                                <td>@item.Quantity</td>
                                <td>
                                    <span class="text-price">
                                        $@item.Price.ToString("F2")
                                    </span>
                                </td>
                                <td>
                                    <span class="fw-semibold text-price">
                                        $@(item.Price* item.Quantity)
                                    </span>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

        @if (!string.IsNullOrEmpty(Model.CancellationReason))
        {
            <div class="alert alert-warning mt-3">
                <strong>Cancellation Reason:</strong> @Model.CancellationReason
            </div>
        }

        <!-- الأزرار -->
        <div class="mt-4 d-flex justify-content-between">
            <a asp-action="MyOrders" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left"></i> Back to Orders
            </a>

            @if (Model.Status == "Pending")
            {
                <form asp-action="Cancel" asp-route-id="@Model.Id" method="post" class="d-inline">
                    @Html.AntiForgeryToken()
                    <button type="submit"
                            class="btn btn-sm btn-outline-danger"
                            onclick="return confirm('Are you sure you want to cancel this order?');">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </form>
            }
        </div>
    </div>
</main>

<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />

<style>
    .page {
        min-height: 80vh;
    }

    .text-price {
        color: #8B4513; /* نفس اللون بتاع السعر في صفحة المنتجات */
    }

    .table-hover tbody tr:hover {
        background-color: #f2f2f2;
    }
</style>
